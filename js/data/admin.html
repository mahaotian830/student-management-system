<!DOCTYPE html>
<html>
<head>
    <title>ç®¡ç†å‘˜é¢æ¿</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .admin-card {
            background: white;
            padding: 20px;
            margin: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .admin-card h3 { color: #dc3545; margin-top: 0; }
        .stat { font-size: 24px; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <h1>ğŸ‘‘ ç®¡ç†å‘˜é¢æ¿</h1>
    <nav>
        <a href="dashboard.html">ç”¨æˆ·é¢æ¿</a>
        <a href="#" onclick="logout()">é€€å‡º</a>
    </nav>
    
    <div style="display: flex; flex-wrap: wrap; margin: 20px;">
        <div class="admin-card">
            <h3>ç”¨æˆ·ç®¡ç†</h3>
            <p>æ€»ç”¨æˆ·æ•°: <span class="stat" id="userCount">0</span></p>
            <button onclick="manageUsers()">ç®¡ç†ç”¨æˆ·</button>
        </div>
        
        <div class="admin-card">
            <h3>æ•°æ®ç»Ÿè®¡</h3>
            <p>å­¦ç”Ÿ: <span class="stat" id="studentCount">0</span></p>
            <p>æ•™å¸ˆ: <span class="stat" id="teacherCount">0</span></p>
            <p>è¯¾ç¨‹: <span class="stat" id="courseCount">0</span></p>
        </div>
        
        <div class="admin-card">
            <h3>ç³»ç»Ÿç®¡ç†</h3>
            <button onclick="clearAllData()" style="background: #dc3545;">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
            <button onclick="exportData()" style="margin-top: 10px;">å¯¼å‡ºæ•°æ®</button>
            <button onclick="importData()" style="margin-top: 10px;">å¯¼å…¥æ•°æ®</button>
        </div>
    </div>
    
    <div class="admin-card" style="margin: 20px;">
        <h3>ç³»ç»Ÿæ—¥å¿—</h3>
        <textarea id="logs" rows="5" style="width: 100%;" readonly>ç³»ç»Ÿå¯åŠ¨...</textarea>
        <button onclick="clearLogs()">æ¸…ç©ºæ—¥å¿—</button>
    </div>
    
    <script src="js/auth.js"></script>
    <script>
        // æ£€æŸ¥æ˜¯å¦ä¸ºç®¡ç†å‘˜
        const user = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
        if (user.role !== 'admin') {
            alert('éœ€è¦ç®¡ç†å‘˜æƒé™ï¼');
            window.location.href = 'login.html';
        }
        
        function loadStats() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            const teachers = JSON.parse(localStorage.getItem('teachers') || '[]');
            const courses = JSON.parse(localStorage.getItem('courses') || '[]');
            
            document.getElementById('userCount').textContent = users.length;
            document.getElementById('studentCount').textContent = students.length;
            document.getElementById('teacherCount').textContent = teachers.length;
            document.getElementById('courseCount').textContent = courses.length;
            
            addLog('ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿ');
        }
        
        function manageUsers() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            let msg = 'ç”¨æˆ·åˆ—è¡¨:\n';
            users.forEach(u => {
                msg += `${u.id}. ${u.username} (${u.role})\n`;
            });
            alert(msg);
        }
        
        function clearAllData() {
            if (confirm('ç¡®å®šæ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                localStorage.clear();
                sessionStorage.clear();
                addLog('ç®¡ç†å‘˜æ¸…ç©ºäº†æ‰€æœ‰æ•°æ®');
                alert('æ•°æ®å·²æ¸…ç©ºï¼Œå³å°†åˆ·æ–°é¡µé¢');
                location.reload();
            }
        }
        
        function addLog(message) {
            const logs = document.getElementById('logs');
            const time = new Date().toLocaleTimeString();
            logs.value += `\n[${time}] ${message}`;
            logs.scrollTop = logs.scrollHeight;
        }
        
        window.onload = loadStats;
    </script>
</body>
</html>
